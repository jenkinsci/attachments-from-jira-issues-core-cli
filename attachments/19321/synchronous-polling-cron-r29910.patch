Index: src/main/java/hudson/triggers/Trigger.java
===================================================================
--- src/main/java/hudson/triggers/Trigger.java	(r√©vision 29910)
+++ src/main/java/hudson/triggers/Trigger.java	(copie de travail)
@@ -147,8 +147,8 @@
      * some polling work.
      */
     protected Trigger(String cronTabSpec) throws ANTLRException {
-        this.spec = cronTabSpec;
-        this.tabs = CronTabList.create(cronTabSpec);
+        this.spec = cronTabSpec == null ? "" : cronTabSpec;
+        this.tabs = CronTabList.create(spec);
     }
 
     /**
@@ -223,17 +223,23 @@
                 // Process SCMTriggers in the order of dependencies. Note that the crontab spec expressed per-project is
                 // ignored, only the global setting is honored. The polling job is submitted only if the previous job has
                 // terminated.
-                // FIXME allow to set a global crontab spec
-                previousSynchronousPolling = scmd.getExecutor().submit(new DependencyRunner(new ProjectRunnable() {
-                    public void run(AbstractProject p) {
-                        for (Trigger t : (Collection<Trigger>) p.getTriggers().values()) {
-                            if (t instanceof SCMTrigger) {
-                                LOGGER.fine("synchronously triggering SCMTrigger for project " + t.job.getName());
-                                t.run();
+                try {
+                    CronTabList tabList = CronTabList.create(scmd.synchronousPollingCronTabSpec);
+                    if (tabList.check(cal)) {
+                        previousSynchronousPolling = scmd.getExecutor().submit(new DependencyRunner(new ProjectRunnable() {
+                            public void run(AbstractProject p) {
+                                for (Trigger t : (Collection<Trigger>) p.getTriggers().values()) {
+                                    if (t instanceof SCMTrigger) {
+                                        LOGGER.fine("synchronously triggering SCMTrigger for project " + t.job.getName());
+                                        t.run();
+                                    }
+                                }
                             }
-                        }
+                        }));
                     }
-                }));
+                } catch (ANTLRException e) {
+                    LOGGER.log(Level.WARNING, "Incorrect cron tab for synchronous polling", e);
+                }
             } else {
                 LOGGER.fine("synchronous polling has detected unfinished jobs, will not trigger additional jobs.");
             }
Index: src/main/java/hudson/triggers/SCMTrigger.java
===================================================================
--- src/main/java/hudson/triggers/SCMTrigger.java	(r√©vision 29910)
+++ src/main/java/hudson/triggers/SCMTrigger.java	(copie de travail)
@@ -92,6 +92,10 @@
         }
     }
 
+    public final boolean isSynchronousPolling() {
+        return getDescriptor().synchronousPolling;
+    }
+
     @Override
     public DescriptorImpl getDescriptor() {
         return (DescriptorImpl)super.getDescriptor();
@@ -128,6 +132,11 @@
         public boolean synchronousPolling = false;
 
         /**
+         * If synchronous polling is enabled, it will respect this specified cron tab
+         */
+        public String synchronousPollingCronTabSpec = "";
+
+        /**
          * Max number of threads for SCM polling.
          * 0 for unbounded.
          */
@@ -138,6 +147,22 @@
             resizeThreadPool();
         }
 
+        public final boolean isSynchronousPolling() {
+            return synchronousPolling;
+        }
+
+        public void setSynchronousPolling(boolean synchronousPolling) {
+            this.synchronousPolling = synchronousPolling;
+        }
+
+        public final String getSynchronousPollingCronTabSpec() {
+            return synchronousPollingCronTabSpec;
+        }
+
+        public void setSynchronousPollingCronTabSpec(String synchronousPollingCronTabSpec) {
+            this.synchronousPollingCronTabSpec = synchronousPollingCronTabSpec;
+        }
+
         public boolean isApplicable(Item item) {
             return item instanceof SCMedItem;
         }
@@ -222,12 +247,26 @@
 
         @Override
         public boolean configure(StaplerRequest req, JSONObject json) throws FormException {
-            String t = req.getParameter("poll_scm_threads");
-            if(t==null || t.length()==0)
-                setPollingThreadCount(0);
-            else
-                setPollingThreadCount(Integer.parseInt(t));
 
+            boolean syncPoll = Boolean.valueOf(req.getParameter("poll_scm_sync"));
+            synchronousPolling = syncPoll;
+            if (syncPoll) {
+                setPollingThreadCount(1);
+                String cronSpec = req.getParameter("poll_scm_sync_spec");
+                if (cronSpec == null) {
+                    setSynchronousPollingCronTabSpec("");
+                } else {
+                    setSynchronousPollingCronTabSpec(cronSpec);
+                }
+            } else {
+                String t = req.getParameter("poll_scm_threads");
+                if (t == null || t.length() == 0) {
+                    setPollingThreadCount(0);
+                } else {
+                    setPollingThreadCount(Integer.parseInt(t));
+                }
+            }
+
             // Save configuration
             save();
 
Index: src/main/resources/hudson/triggers/SCMTrigger/global_pt_BR.properties
===================================================================
--- src/main/resources/hudson/triggers/SCMTrigger/global_pt_BR.properties	(r√©vision 29910)
+++ src/main/resources/hudson/triggers/SCMTrigger/global_pt_BR.properties	(copie de travail)
@@ -22,3 +22,4 @@
 
 SCM\ Polling=Vota\u00E7\u00E3o de SCM
 Max\ \#\ of\ concurrent\ polling=N\u00FAmero m\u00E1ximo de vota\u00E7\u00F5es concorrentes
+Schedule=Agenda
Index: src/main/resources/hudson/triggers/SCMTrigger/global_es.properties
===================================================================
--- src/main/resources/hudson/triggers/SCMTrigger/global_es.properties	(r√©vision 29910)
+++ src/main/resources/hudson/triggers/SCMTrigger/global_es.properties	(copie de travail)
@@ -22,4 +22,4 @@
 
 SCM\ Polling=Peticiones al repositorio
 Max\ \#\ of\ concurrent\ polling=N˙mero m·ximo de peticiones concurrentes.
-
+Schedule=Programador
Index: src/main/resources/hudson/triggers/SCMTrigger/global_fr.properties
===================================================================
--- src/main/resources/hudson/triggers/SCMTrigger/global_fr.properties	(r√©vision 29910)
+++ src/main/resources/hudson/triggers/SCMTrigger/global_fr.properties	(copie de travail)
@@ -21,4 +21,7 @@
 # THE SOFTWARE.
 
 SCM\ Polling=Interrogation de la base de code
+Use\ threaded\ polling=Interrogation parallËle
 Max\ \#\ of\ concurrent\ polling=Nombre maximum d''interrogations parallËles
+Use\ synchronous\ polling=Interrogation synchrone
+Schedule=Planning
Index: src/main/resources/hudson/triggers/SCMTrigger/config.jelly
===================================================================
--- src/main/resources/hudson/triggers/SCMTrigger/config.jelly	(r√©vision 29910)
+++ src/main/resources/hudson/triggers/SCMTrigger/config.jelly	(copie de travail)
@@ -24,6 +24,11 @@
 
 <j:jelly xmlns:j="jelly:core" xmlns:st="jelly:stapler" xmlns:d="jelly:define" xmlns:l="/lib/layout" xmlns:t="/lib/hudson" xmlns:f="/lib/form">
   <f:entry title="${%Schedule}" help="/help/project-config/timer-format.html">
-    <f:textarea name="scmpoll_spec" checkUrl="'${rootURL}/trigger/TimerTrigger/check?value='+encodeURIComponent(this.value)" value="${instance.spec}"/>
+    <j:if test="${!instance.synchronousPolling}">
+        <f:textarea name="scmpoll_spec" checkUrl="'${rootURL}/trigger/TimerTrigger/check?value='+encodeURIComponent(this.value)" value="${instance.spec}"/>
+    </j:if>
+    <j:if test="${instance.synchronousPolling}">
+        <p><i>${%it will be part of the synchronous polling}</i></p>
+    </j:if>
   </f:entry>
 </j:jelly>
Index: src/main/resources/hudson/triggers/SCMTrigger/global_nl.properties
===================================================================
--- src/main/resources/hudson/triggers/SCMTrigger/global_nl.properties	(r√©vision 29910)
+++ src/main/resources/hudson/triggers/SCMTrigger/global_nl.properties	(copie de travail)
@@ -22,3 +22,4 @@
 
 SCM\ Polling=Bemonstering SCM
 Max\ \#\ of\ concurrent\ polling=Maximaal aantal parallelle bemonsteringen
+Schedule=Planning
Index: src/main/resources/hudson/triggers/SCMTrigger/config_fr.properties
===================================================================
--- src/main/resources/hudson/triggers/SCMTrigger/config_fr.properties	(r√©vision 29910)
+++ src/main/resources/hudson/triggers/SCMTrigger/config_fr.properties	(copie de travail)
@@ -21,3 +21,4 @@
 # THE SOFTWARE.
 
 Schedule=Planning
+it\ will\ be\ part\ of\ the\ synchronous\ polling=cela fera parti de l''interrogation synchrone
Index: src/main/resources/hudson/triggers/SCMTrigger/global_tr.properties
===================================================================
--- src/main/resources/hudson/triggers/SCMTrigger/global_tr.properties	(r√©vision 29910)
+++ src/main/resources/hudson/triggers/SCMTrigger/global_tr.properties	(copie de travail)
@@ -22,3 +22,4 @@
 
 SCM\ Polling=SCM Kontrol\u00fc
 Max\ \#\ of\ concurrent\ polling=E\u015fzamanl\u0131 kontrol say\u0131s\u0131
+Schedule=Planla
Index: src/main/resources/hudson/triggers/SCMTrigger/global_ru.properties
===================================================================
--- src/main/resources/hudson/triggers/SCMTrigger/global_ru.properties	(r√©vision 29910)
+++ src/main/resources/hudson/triggers/SCMTrigger/global_ru.properties	(copie de travail)
@@ -22,3 +22,4 @@
 
 SCM\ Polling=\u041e\u043f\u0440\u043e\u0441 SCM \u043e\u0431 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f\u0445
 Max\ \#\ of\ concurrent\ polling=\u041c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u043e\u0434\u043d\u043e\u0432\u0440\u0435\u043c\u0435\u043d\u043d\u044b\u0445 \u043e\u043f\u0440\u043e\u0441\u043e\u0432
+Schedule=\u0420\u0430\u0441\u043f\u0438\u0441\u0430\u043d\u0438\u0435
Index: src/main/resources/hudson/triggers/SCMTrigger/global_de.properties
===================================================================
--- src/main/resources/hudson/triggers/SCMTrigger/global_de.properties	(r√©vision 29910)
+++ src/main/resources/hudson/triggers/SCMTrigger/global_de.properties	(copie de travail)
@@ -22,3 +22,4 @@
 
 SCM\ Polling=Abfrage des Source Code Management Systems
 Max\ \#\ of\ concurrent\ polling=Maximale Anzahl gleichzeitiger Abfragen
+Schedule=Zeitplan
Index: src/main/resources/hudson/triggers/SCMTrigger/global_ja.properties
===================================================================
--- src/main/resources/hudson/triggers/SCMTrigger/global_ja.properties	(r√©vision 29910)
+++ src/main/resources/hudson/triggers/SCMTrigger/global_ja.properties	(copie de travail)
@@ -22,3 +22,4 @@
 
 SCM\ Polling=SCM\u306E\u30DD\u30FC\u30EA\u30F3\u30B0
 Max\ \#\ of\ concurrent\ polling=\u6700\u5927\u540C\u6642\u4E26\u884C\u30DD\u30FC\u30EA\u30F3\u30B0\u6570
+Schedule=\u30b9\u30b1\u30b8\u30e5\u30fc\u30eb
Index: src/main/resources/hudson/triggers/SCMTrigger/global.jelly
===================================================================
--- src/main/resources/hudson/triggers/SCMTrigger/global.jelly	(r√©vision 29910)
+++ src/main/resources/hudson/triggers/SCMTrigger/global.jelly	(copie de travail)
@@ -29,11 +29,17 @@
       so let's hide this option for new users to avoid confusing them.
     -->
     <f:section title="${%SCM Polling}">
-      <f:entry title="${%Max # of concurrent polling}"
-               help="/help/triggers/SCMTrigger/concurrency.html">
-        <f:textbox name="poll_scm_threads"
-          value="${descriptor.pollingThreadCount==0 ? '' : descriptor.pollingThreadCount}"/>
-      </f:entry>
+      <f:radioBlock name="poll_scm_sync" value="false" title="${%Use threaded polling}" checked="${!instance.synchronousPolling}">
+        <f:entry title="${%Max # of concurrent polling}" help="/help/triggers/SCMTrigger/concurrency.html">
+          <f:textbox name="poll_scm_threads"
+                value="${descriptor.pollingThreadCount==0 ? '' : descriptor.pollingThreadCount}"/>
+        </f:entry>
+      </f:radioBlock>
+      <f:radioBlock name="poll_scm_sync" value="true" title="${%Use synchronous polling}" checked="${instance.synchronousPolling}">
+        <f:entry title="${%Schedule}">
+            <f:textarea name="poll_scm_sync_spec" checkUrl="'${rootURL}/trigger/TimerTrigger/check?value='+encodeURIComponent(this.value)" value="${instance.synchronousPollingCronTabSpec}"/>
+        </f:entry>
+      </f:radioBlock>
     </f:section>
   </j:if>
 </j:jelly>
